---
layout: post
title: "负荷数据集读取"
date:   2024-4-20
tags: [毕业设计]
comments: false
author: Shareef
---

## 简介

下面是一段读取电工杯负荷数据集的python代码，读取结果包括负荷（Load）、日期(date)和时刻(time)。皆存储为二维数组的形式。

<!-- more -->

## 代码如下

```python
import pandas as pd
def read_load(file_path, sheet_name, start_row, end_row):
    df = pd.read_excel(file_path, sheet_name=sheet_name)
    selected_data = df.iloc[start_row-1:end_row, 1:97]
    rounded_data = selected_data.round(4)
    flattened_data = rounded_data.values.flatten()
    return flattened_data
def read_date(file_path, sheet_name, start_row, end_row):
    df = pd.read_excel(file_path, sheet_name=sheet_name)
    selected_data = df.iloc[start_row-1:end_row, 0]
    rounded_data = selected_data.round(4)
    flattened_data = rounded_data.values.flatten()
    return flattened_data
file_path = 'data.xlsx'
sheet_name = 'Area2_Load'
start_row = 1
end_row = 2201
load= read_load(file_path, sheet_name, start_row, end_row)
date=read_date(file_path, sheet_name, start_row, end_row)
r=0
time=[0]*211296
for i in range(0,211295):
    r=r+1
    if r>96:
        r=r-96
        time[i]=r
    else:
        time[i]=r
```

